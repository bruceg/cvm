<html>
<body>

<h2><a href="cvm.html">CVM</a></h2>

<h1>CVM Fact Definitions</h1>

<h2>Types</h2>

<p>Facts may have one of two types:</p>

<ul>

<li>string: An arbitrary length series of ASCII characters (not
containing <tt>NUL</tt> in the version 1 protocol).</li>

<li>integer: A series of ASCII numerals interpreted as an unsigned
decimal value.</tt></li>

</ul>

<h2>Numbering</h2>

<p>All predefined fact numbers will have values between 1 and 127
inclusive.  All other fact numbers (from 128 to 255) are reserved for
local or experimental use.  Facts marked as "required" must be present
at least once in the result.  Facts marked as "multiple" may be
present more than once; all other facts are optional and must be
present at most once.  Facts may be reported in any order, and that
order carries no significance.</p>

<table border=1>

<tr>
 <th>#</th>
 <th>Name</th>
 <th>Type</th>
 <th>Required/<br>Optional/<br>Multiple</th>
 <th>Description</th>
</tr>

<tr>
 <td><tt>1</tt></td>
 <td><tt>CVM_FACT_USERNAME</tt></td>
 <td>string</td>
 <td>Required</td>
 <td>The login user name.</td>
</tr>

<tr>
 <td><tt>2</tt></td>
 <td><tt>CVM_FACT_USERID</tt></td>
 <td>integer</td>
 <td>Required</td>
 <td>The user numerical ID.</td>
</tr>

<tr>
 <td><tt>3</tt></td>
 <td><tt>CVM_FACT_GROUPID</tt></td>
 <td>integer</td>
 <td>Required</td>
 <td>The group numerical ID.</td>
</tr>

<tr>
 <td><tt>4</tt></td> 
 <td><tt>CVM_FACT_REALNAME</tt></td>
 <td>string</td>
 <td>Optional</td>
 <td>The user's real name.</td>
</tr>

<tr>
 <td><tt>5</tt></td> 
 <td><tt>CVM_FACT_DIRECTORY</tt></td>
 <td>string</td>
 <td>Required</td>
 <td>The "home" directory.</td>
</tr>

<tr>
 <td><tt>6</tt></td> 
 <td><tt>CVM_FACT_SHELL</tt></td>
 <td>string</td>
 <td>Optional</td>
 <td>The login shell.</td>
</tr>

<tr>
 <td><tt>7</tt></td> 
 <td><tt>CVM_FACT_GROUPNAME</tt></td>
 <td>string</td>
 <td>Optional</td>
 <td>The login group name, as reported by the system tables.</td>
</tr>

<tr>
 <td><tt>8</tt></td> 
 <td><tt>CVM_FACT_SUPP_GROUPID</tt></td>
 <td>integer</td>
 <td>Optional<br>Multiple</td>
 <td>Supplemental group ID list, must contain the primary group ID.</td>
</tr>

<tr>
 <td><tt>9</tt></td> 
 <td><tt>CVM_FACT_SYS_USERNAME</tt></td>
 <td>string</td>
 <td>Optional</td>
 <td>The system user name.  For virtual login systems, this may differ
 from fact #1.  Where present, this should be the user name associated
 with the user ID as reported by the system tables (ie
 <tt>getpwuid</tt>).</td>
</tr>

<tr>
 <td><tt>10</tt></td> 
 <td><tt>CVM_FACT_SYS_DIRECTORY</tt></td>
 <td>string</td>
 <td>Optional</td>
 <td>The base "home" directory.  For virtual login systems, this may
 differ from fact #5.  Where present, this should be the directory
 associated with the user ID as reported by the system tables (ie
 <tt>getpwuid</tt>).</td>
</tr>

<tr>
 <td><tt>11</tt></td> 
 <td><tt>CVM_FACT_OFFICE_LOCATION</tt></td>
 <td>string</td>
 <td>Optional</td>
 <td>The office location from the GECOS field.</td>
</tr>

<tr>
 <td><tt>12</tt></td> 
 <td><tt>CVM_FACT_WORK_PHONE</tt></td>
 <td>string</td>
 <td>Optional</td>
 <td>The work phone number from the GECOS field.</td>
</tr>

<tr>
 <td><tt>13</tt></td> 
 <td><tt>CVM_FACT_HOME_PHONE</tt></td>
 <td>string</td>
 <td>Optional</td>
 <td>The home phone number from the GECOS field.</td>
</tr>

<tr>
 <td><tt>14</tt></td> 
 <td><tt>CVM_FACT_DOMAIN</tt></td>
 <td>string</td>
 <td>Optional</td>
 <td>The domain name associated with the validated credentials.</td>
</tr>

<tr>
 <td><tt>15</tt></td> 
 <td><tt>CVM_FACT_MAILBOX</tt></td>
 <td>string</td>
 <td>Optional</td>
 <td>The path to the mailbox file or directory.  If this path is not
prefixed with a slash ('/'), it must be interpreted as relative to the
home directory.</td>
</tr>

<tr>
 <td><tt>16</tt></td>
 <td><tt>CVM_FACT_OUTOFSCOPE</tt></td>
 <td>integer</td>
 <td>Optional</td>
 <td>This fact is only relevant on permanent failures.  If present, a
   non-zero value indicates that validation failed because the given
   credentials were outside of the scope for which the module is
   authoritative.</td>
</tr>

</table>

</body>
</html>
