<asserts qmail>

mkdir users
(
  uid=`id -u`
  gid=`id -g`
  len=`echo $src$uid$gid | wc -c`
  printf "+6,%d:!user\0->user\0000$uid\0000$gid\0000$src\0\0\n" $(($len+8))
  printf "+6,%d:!user-->user\0000$uid\0000$gid\0000$src\0-\0\n" $(($len+9))
  echo
) | cdbmake users/cdb users/tmp

mkdir control
echo test.tld:user >control/virtualdomains

(
  printf '+4,69:virt->\x2\x8\x1\0$1$aSoIrl/J$TmAwoxKzrPJ0IaW5UvX4A0\0./virt\0\0\0-\0-\0-\0-\00001016731358\0-\0\n'
  echo
) | cdbmake passwd.cdb passwd.tmp

<result>
