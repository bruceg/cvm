<html>
<body>

<h2><a href="cvm.html">CVM</a></h2>

<h1>The cvm-qmail Module</h1>

<h2>Synopsis:</h2> <p>qmail configuration lookup module</p>

<h2>Credentials:</h2>

<p>None, only operates as a lookup module.</p>

<h2>Description:</h2>

<p>This module uses the standard qmail configuration files to determine
if an address is valid, using the same lookups that qmail would.  It
first checks <tt>control/locals</tt> and then
<tt>control/virtualdomains</tt> to determine if the domain is valid, and
to determine the prefix to add to virtual domain usernames.  It then
looks up the resulting username in <tt>users/cdb</tt> (or the system
password table if the CDB does not exist) to determine the correct home
directory.  If the address would require a <tt>.qmail-something</tt>
file, it ensures that that file exists as well, doing <tt>-default</tt>
checks as necessary.</tt>

<h2>Configuration Variables:</h2>

<dl>

<dt><tt>$CVM_QMAIL_MISSINGDOMAIN</tt> (optional)</dt> <dd>If this is set
and the domain name is not a local or virtual qmail domain, this domain
name is substituted and the lookup succeeds.  This allows for setups
where domains listed in <tt>control/rcpthosts</tt> and
<tt>control/morercpthosts.cdb</tt> (which are accepted by the SMTP
receiver) are not listed as local or virtual domains.  If this is set to
an empty value, "<tt>localhost</tt>" is substituted.</dd>

<dt><tt>$CVM_QMAIL_MISSINGUSER</tt> (optional)</dt> <dd>When missing
domain substitution is being done, the value of this variable is used to
replace the username.  The value must exist as a valid system user.
Defaults to "<tt>alias</tt>" which will normally exist on all qmail
systems.</dd>

<dt><tt>$QMAIL_ROOT</tt> (optional)</dt> <dd>The root directory under
which all the qmail configuration files are expected to be found.
Defaults to "<tt>/var/qmail</tt>", which is the normal qmail install
path.</dd>

<dt><tt>$CVM_QMAIL_ASSUME_LOCAL</tt> (optional)</dt> <dd>If set, all
domains not found in <tt>control/virtualdomains</tt> are assumed to be
local domains.</dd>

</dl>

</body>
</html>
