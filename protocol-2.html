<html>
<body>

<h2><a href="cvm.html">CVM</a></h2>
<h2><a href="protocol.html">CVM Protocol</a></h2>

<h1>CVM Version 2 Protocol</h1>

<p>Input to and output from the module follows the same format: a four
byte protocol identifier (always "CVM2"), a four byte packet type
identifier, eight bytes of random data (to help prevent spoofing of UDP
responses), followed by a series of tagged strings, and completed with a
single NUL byte.  The total size of either the input and output must not
exceed 512 bytes.  The random data in the response is copied exactly
from the request.</p>

<p>A tagged string consists of a tag byte, a length byte, and that many
bytes of data.  The tag byte identifies what <a
href="credentials.html">credential</a> (in the input request) or what <a
href="facts.html">fact</a> (in the output response) is represented by
the string.</p>

<h2>Input</h2>

<p>The packet type identifier in the input (request) packet is
"<tt>REQ2</tt>".  Example (all numbers are hexadecimal):</p>

<pre>
0000000: 4356 4d32 5245 5132 0102 0304 0506 0708  CVM2REQ2........
0000010: 0108 7573 6572 6e61 6d65 0209 6c6f 6361  ..username..loca
0000020: 6c68 6f73 7403 0870 6173 7377 6f72 6400  lhost..password.
</pre>

<h2>Output</h2>

<p>The following types of response packets are possible:

<dl>
<dt><tt>SUCC</tt> <dd>Authentication succeeded, and the packet contains
a list of <a href="facts.html">facts</a>.

<dt><tt>FAIL</tt> <dd>Authentication rejected, permanent error.  The
credentials were accepted by this module, but are not valid.  The facts
may include an error code number and a message.

<dt><tt>EBAD</tt> <dd>Authentication failed, permanent error.  The
credentials were not accepted by this module.

<dt><tt>ETMP</tt> <dd>Authentication failed, temporary error.

</dl>

<p>Example (all numbers are hexadecimal):</p>

<pre>
0000000: 4356 4d32 5355 4343 0102 0304 0506 0708  CVM2SUCC........
0000010: 0108 7573 6572 6e61 6d65 0205 3132 3334  ..username..1234
0000020: 3503 0532 3334 3536 00                   5..23456.
</pre>

</body>
</html>
