<html>
<body>

<h2><a href="cvm.html">CVM</a></h2>

<h1>CVM Client Library</h1>

<p>The CVM client library defines the following functions:<dl>

<dt><tt>int cvm_authenticate(const char* module, const char* account,
const char* domain, const char** credentials, int parse_account)</tt>
<dd><p>This is the main entry point to the library.  Simply set up the
credentials as an array with a trailing NULL pointer and call
<tt>authenticate</tt>.  If the <tt>domain</tt> parameter is a NULL
pointer, it will be treated as an empty string; no other parameter may
be NULL.  The function will return 0 if authentication succeeded and
an <a href="errors.html">error code</a> otherwise.</p>

<p>If <tt>parse_account</tt> is true then <tt>account</tt> is searched
for the last instance of any character from
<tt>cvm_account_split_chars</tt>.  If found, <tt>domain</tt> is
replaced with the portion of <tt>account</tt> following that
character, and <tt>account</tt> is truncated before that character.
<tt>cvm_account_split_chars</tt> defaults to "<tt>@</tt>", which may
be overridden by either setting it to a different string from the
client program or by setting the <tt>$CVM_ACCOUNT_SPLIT_CHARS</tt>
environment variable.  Setting it to an empty string will effectively
prevent parsing of the account name, no matter what
<tt>parse_account</tt> may be set to.</p>

<p>If authentication succeeds, this routine automatically retrieves
<tt>cvm_fact_username</tt>, <tt>cvm_fact_userid</tt>,
<tt>cvm_fact_groupid</tt>, <tt>cvm_fact_directory</tt>, and
<tt>cvm_fact_shell</tt>.  <tt>cvm_fact_realname</tt>,
<tt>cvm_fact_groupname</tt>, <tt>cvm_fact_sys_username</tt>,
<tt>cvm_fact_sys_directory</tt>, and <tt>cvm_fact_domain</tt> are also
set if they were present in the results.</p>

<dt><tt>int cvm_fact_str(int number, const char** data)</tt>
<dd><p>Retrieves a <a href="facts.html">fact</a> from the data
returned by the module as a NUL-terminated string.  Returns zero if
the fact was present, and <tt>CVME_NOFACT</tt> otherwise.  Successive
calls to this function with the same <tt>number</tt> return subsequent
facts if more than one instance of the fact was present.</p>

<dt><tt>int cvm_fact_uint(int number, unsigned long* data)</tt>
<dd><p>Retrieves a <a href="facts.html">fact</a> from the data
returned by the module as an unsigned integer.  Returns zero if the
fact was present and was an unsigned integer.  Returns
<tt>CVME_BAD_MODDATA</tt> if the fact was present but was not an
unsigned integer.  Successive calls to this function with the same
<tt>number</tt> return subsequent facts if more than one instance of
the fact was present.</p>

</dl></p>

